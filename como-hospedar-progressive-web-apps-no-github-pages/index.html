<!DOCTYPE html><html ‚ö° lang="pt-br"><head><meta charset="utf-8"><link rel="manifest" href="/manifest.json"><script async src="https://cdn.ampproject.org/v0.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Como hospedar Progressive Web Apps no GitHub Pages ¬∑ Joselito</title><link rel="canonical" href="https://joseli.to/como-hospedar-progressive-web-apps-no-github-pages/"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta name="description" content="Eu vivo falando da rede social de banco de dados em tempo real chamada Firebase neste blogue digital. O Firebase ja √© conhecido pela suas funcionalidades de Hosting, e basta um firebase deploy para po"><meta name="keywords" content="C√≥digo,firebase,GitHub,PWA,SPA"><meta property="og:type" content="article"><meta property="og:title" content="Como hospedar Progressive Web Apps no GitHub Pages"><meta property="og:url" content="https://joseli.to/como-hospedar-progressive-web-apps-no-github-pages/index.html"><meta property="og:site_name" content="Joselito"><meta property="og:description" content="Eu vivo falando da rede social de banco de dados em tempo real chamada Firebase neste blogue digital. O Firebase ja √© conhecido pela suas funcionalidades de Hosting, e basta um firebase deploy para po"><meta property="og:image" content="https://joselito.space/files/2017/03/1490246451-768x390.png"><meta property="og:updated_time" content="2017-06-03T18:36:31.271Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Como hospedar Progressive Web Apps no GitHub Pages"><meta name="twitter:description" content="Eu vivo falando da rede social de banco de dados em tempo real chamada Firebase neste blogue digital. O Firebase ja √© conhecido pela suas funcionalidades de Hosting, e basta um firebase deploy para po"><meta name="twitter:image" content="https://joselito.space/files/2017/03/1490246451-768x390.png"><meta property="fb:app_id" content="1265807416816197"><meta property="fb:pages" content="191984887960659"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" href="/images/icon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/icon-512x512.png"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="application-name" content="Joselito"><meta name="apple-mobile-web-app-title" content="Joselito"><meta name="theme-color" content="#0000ff"><meta name="msapplication-navbutton-color" content="#0000ff"><meta name="apple-mobile-web-app-status-bar-style" content="#0000ff"><meta name="msapplication-starturl" content="/"><meta name="twitter:site" content="@joselitojunior1"><meta name="twitter:creator" content="@joselitojunior1"><meta property="og:image" content="https://joseli.to/images/share/fb.png"><meta name="twitter:image:src" content="https://joseli.to/images/share/twitter.png"><link rel="alternate" href="/rss.xml" title="Como hospedar Progressive Web Apps no GitHub Pages ¬∑ Joselito" type="application/rss+xml"><link href="https://fonts.googleapis.com/css?family=Space+Mono" rel="stylesheet"><style amp-boilerplate="">body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate="">body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom="">/*! Bassplate | MIT License | http://github.com/basscss/bassplate, normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */@keyframes BackgroundAnimation{0%{background-position:0 99%}50%{background-position:100% 2%}100%{background-position:0 99%}}button{overflow:visible}.list-reset{list-style:none}html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100}body{margin:0}article,footer,header,section{display:block}h1{font-size:2em;margin:.67em 0}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}strong{font-weight:inherit;font-weight:bolder}small{font-size:80%}img{border-style:none}button{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button{text-transform:none}button{-webkit-appearance:button}button::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring{outline:ButtonText dotted 1px}.list-reset{padding-left:0}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}.h2{font-size:2rem}.text-decoration-none{text-decoration:none}.clearfix:after,.clearfix:before{content:" ";display:table}.clearfix:after{clear:both}.m0{margin:0}.mr1{margin-right:.5rem}.mr2{margin-right:1rem}.mb2{margin-bottom:1rem}.mx-auto{margin-left:auto}.mx-auto{margin-right:auto}.pl2,.px2{padding-left:1rem}.px2{padding-right:1rem}.px3{padding-left:1.5rem}.pr3,.px3{padding-right:1.5rem}.flex{display:-webkit-box;display:-ms-flexbox;display:flex}@media (min-width:40.06rem){.sm-col-12{width:100%}}@media (min-width:52.06rem){.md-col-10{width:83.33333%}}@media (min-width:64.06rem){.lg-col-8{width:66.66667%}.lg-hide{display:none}}.items-start{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.items-center{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.justify-start{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.justify-between{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.fixed{position:fixed}.top-0{top:0}.right-0{right:0}.left-0{left:0}@media (max-width:40rem){.xs-hide{display:none}}@media (min-width:40.06rem) and (max-width:52rem){.sm-hide{display:none}}@media (min-width:52.06rem) and (max-width:64rem){.md-hide{display:none}}*{box-sizing:border-box}body{background:#fff;color:#4a4a4a;line-height:1.5rem;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,Arial,sans-serif;min-width:315px;overflow-x:hidden;font-smooth:always;-webkit-font-smoothing:antialiased}p{padding:0;margin:0}body{font-family:'Space Mono',Consolas,monospace;line-height:1.618}.post header{margin:0}.header-title{display:block;margin:1.2rem 0;max-height:50px}.posttitle{font-weight:700;margin:0 0 .75rem;font-size:2.5rem}.main{margin:2rem auto}.main section{margin-bottom:2.5rem}a,a:visited{color:#00f;font-weight:700;text-decoration:none}header a,header a:visited{color:#fff;text-transform:uppercase}.clear-list{margin:0;padding:0}.clear-list li{list-style:none}.inline-list li{display:inline-block}.content p{margin-bottom:1.5rem}.meta{display:inline-block}.afo-headerbar{color:#fff;z-index:999;min-height:4rem;background:linear-gradient(270deg,#00f,#8a2be2);background-size:200% 200%;animation:BackgroundAnimation 60s ease infinite}.afo-headerbar+amp-sidebar+*{margin-top:8rem}.afo-navbar-trigger{font-size:2.25rem}.afo-sidebar{width:60vw;margin:0;padding:10px 20px;background:#fff}li.afo-nav-item{margin:1rem 0;text-transform:uppercase}.custom-share-icon{background-color:#00f;border:10px solid transparent;margin:.25rem .5rem 0 0}.poster-footer{margin:1rem 0}.lw{text-transform:lowercase}.keep-reading,footer{margin:1rem 0 0}.article-share-pls{max-width:600px}</style><script async custom-element="amp-install-serviceworker" src="https://cdn.ampproject.org/v0/amp-install-serviceworker-0.1.js"></script><script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script><script async custom-element="amp-facebook-comments" src="https://cdn.ampproject.org/v0/amp-facebook-comments-0.1.js"></script><script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script></head><body><header class="afo-headerbar fixed flex justify-between items-center top-0 left-0 right-0 pl2 pr3"><div><a href="/" class="header-title"><amp-img src="/images/logo.svg" alt="Welcome" height="50" width="100"></amp-img></a></div><div role="button" on="tap:header-sidebar.toggle" tabindex="0" class="afo-navbar-trigger md-hide lg-hide sm-hide">[‚â°]</div><ul class="inline-list xs-hide"><li class="afo-headerbar-item mr1">[<a href="https://sininho.joseli.to" class="text-decoration-none">üîî Notifica√ß√µes</a>]</li><li class="afo-headerbar-item mr1">[<a href="/sobre/" class="text-decoration-none">Sobre</a>]</li><li class="afo-headerbar-item mr1">[<a href="/arquivos/" class="text-decoration-none">Artigos</a>]</li><li class="afo-headerbar-item mr1">[<a href="https://codelabs.joseli.to" class="text-decoration-none">Codelabs</a>]</li><li class="afo-headerbar-item mr1">[<a href="/palestras/" class="text-decoration-none">Palestras</a>]</li></ul></header><amp-sidebar id="header-sidebar" class="afo-sidebar px3" layout="nodisplay"><div class="flex justify-start items-center"><div role="button" on="tap:header-sidebar.toggle" tabindex="0" class="afo-navbar-trigger items-start">‚úï</div></div><ul class="list-reset m0"><li class="afo-nav-item"><a href="https://sininho.joseli.to" class="text-decoration-none">üîî Notifica√ß√µes</a></li><li class="afo-nav-item"><a href="/sobre/" class="text-decoration-none">Sobre</a></li><li class="afo-nav-item"><a href="/arquivos/" class="text-decoration-none">Artigos</a></li><li class="afo-nav-item"><a href="https://codelabs.joseli.to" class="text-decoration-none">Codelabs</a></li><li class="afo-nav-item"><a href="/palestras/" class="text-decoration-none">Palestras</a></li></ul></amp-sidebar><div class="clearfix main"><div class="sm-col-12 md-col-10 lg-col-8 px2 mx-auto"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><div class="postdate mr2">üìÖ <time datetime="2017-03-23T06:44:44.000Z" itemprop="datePublished">2017-03-23</time></div><div>üïë 7 min</div><h1 class="posttitle" itemprop="name headline">Como hospedar Progressive Web Apps no GitHub Pages</h1><div class="meta"><div class="article-tag"><a class="tag-link" href="/tags/codigo/">C√≥digo</a> <a class="tag-link" href="/tags/github/">GitHub</a> <a class="tag-link" href="/tags/pwa/">PWA</a> <a class="tag-link" href="/tags/spa/">SPA</a> <a class="tag-link" href="/tags/firebase/">firebase</a></div></div></header><div id="toc-footer"></div><div class="content" itemprop="articleBody"><p>Eu vivo falando da rede social de banco de dados em tempo real chamada <strong>Firebase</strong> neste blogue digital. O Firebase ja √© conhecido pela suas funcionalidades de Hosting, e basta um <code>firebase deploy</code><strong> </strong>para por um projeto no ar. Por√©m, como eu sou uma pessoa chata e desagrad√°vel, eu n√£o gosto muito de usar o Firebase Hosting quando eu n√£o estou usando nada <strong>al√©m do pr√≥piro Firebase Hosting</strong>.</p><p>Explico: quando estamos usando mesmo o Firebase, a√≠ tudo bem, estamos tudo em casa, tem o Database, tem o Hosting, tem algum servi√ßo de autentica√ß√£o&#8230; se justifica deixar tudo l√°. Mas quando eu n√£o t√¥ usando outra coisa sem ser o Hosting, aparecem certas coisas que me incomodam: ter que criar um projeto novo no Firebase (que s√£o limitados, caso n√£o saiba), ter que inicializar o reposit√≥rio com as configura√ß√µes, usar o Firebase-CLI al√©m de &#8211; obviamente &#8211; o pr√≥prio Git, e configurar o dom√≠nio e SSL n√£o √© dif√≠cil; mas √© chato, demorado e manual (ao menos pros meus padr√µes).</p><p>Quando essa situa√ß√£o acontece, eu prefiro usar o <strong>GitHub Pages</strong> para por minhas p√°ginas est√°ticas no ar. Eu j√° ia estar usando o Git de todo jeito, agora eu s√≥ tenho que dar push na branch certa e ele vai estar no ar. Nesses dias rolou algo interessante, um problema que eu nunca tinha enfrentado antes. Quando a gente desenvolve um Progressive Web App, √© normal ele ter ao menos um tipo de autentica√ß√£ozinha que seja. Ent√£o, eu sempre hospedava j√° no Firebase.</p><p>O Firebase Hosting tem um tipo de configura√ß√£o especial para <strong>Single Page Apps</strong>: como √© sabido, single page apps tem s√≥ o <code>index.html</code> e todo o conte√∫do √© adicionado e removido do DOM, e mudamos os valores e URL via JavaScript. No Firebase podemos configurar para que todos os requests v√°lidos sejam redirecionados para o <code>index</code>, e assim √© garantido que o usu√°rio acessar√° o conte√∫do devido, mesmo fazendo um acesso direto a uma p√°gina espec√≠fica sem ser a pr√≥pria home. √â s√≥ por isso aqui no seu <code>firebase.json</code>:</p><pre class="prettyprint lang-json" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">"rewrites": [ {
  "source": "**",
  "destination": "/index.html"
} ]</pre><p>Ou seja, quando acessamos algum SPA hospedado no Firebase por: <code>https://meu.pwa/pagina</code>, o Firebase vai redirecionar o request para <code>index.html</code> e &#8211; se voc√™ fez tudo certo &#8211; vai receber de par√¢metro &#8220;pagina&#8221; e voc√™ redireciona o usu√°rio pro conte√∫do devido.</p><p>Mas no GitHub Pages, se eu tentar acessar <code>https://meu.pwa/pagina</code>, o que acontece? Isso mesmo:</p><p><img src="https://joselito.space/files/2017/03/1490246451-768x390.png" alt="Print Screen da p√°gina de 404 do GitHub"></p><p>O famoso erro 404. O GitHub quando voc√™ tenta acessar <code>https://meu.pwa/pagina</code> ele tenta retornar <code>https://meu.pwa/pagina/index.html</code>. Como essa p√°gina n√£o existe, ele retorna a p√°gina de erro 404. Se voc√™ parar pra pensar, realmente o servidor est√° coberto de raz√£o.</p><p>Eu podia nesse momento engolir o orgulho e voltar chorando pr&#8217;os bra√ßos do Firebase. Mas eu sou Brasileiro e n√£o desisto nunca. Algum jeito tem que ter, n√£o √© poss√≠vel. E como em 99,9% dos casos, tem solu√ß√£o pra tudo.</p><p>Achei o reposit√≥rio do ilutre desconhecido <a href="https://github.com/rafrex/" target="_blank" rel="external">@rafrex</a>. Eu podia terminar <a href="https://github.com/rafrex/spa-github-pages" target="_blank" rel="external">o post aqui linkando o reposit√≥rio</a>, mas l√° tem tanto arquivo, tanto texto, tanta coisa ~desneces√°ria (apesar de entender porqu√™ eles est√£o l√°) que vou pular a abertura da s√©rie pra voc√™ e explicar o que tem que ser feito.</p><p>No Firebase, ele redireciona todos os requests pra <code>index.html</code>. No GItHub n√£o. Mas se voc√™ parar pra pensar, dado que √© um SPA. S√≥ existem duas possibilidades de acesso direto a arquivos:</p><p>&#8211; O pr√≥prio <code>index.html</code></p><p>&#8211; A p√°gina de erro 404</p><p>Aqui que a m√°gica acontece. Tecnicamente falando, o GitHub faz a mesma coisa que o Firebase, s√≥ que ao inv√©s do <code>index.html</code> ele sempre redireciona para <code>404.html</code>. Se a gente der um jeito de redirecionar o <code>404</code> para o <code>index</code> e passar os par√¢metros, estamos feitos, tudo funciona. Ent√£o, a gente tem que fazer duas coisas. Primeiro, escrever isso aqui no c√≥digo da nossa <strong>404.html</strong>:</p><pre class="prettyprint lang-html" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;&lt;/title&gt;
    &lt;script type="text/javascript"&gt;
      // Copyright (c) 2016 Rafael Pedicini, licensed under the MIT License
      var pathPrefix = false;
      var l = window.location;
      l.replace(
        l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') +
        l.pathname.split('/').slice(0, 2 * pathPrefix).join('/') + '/?p=/' +
        l.pathname.slice(1).split('/').slice(pathPrefix).join('/').replace(/&amp;/g, '~and~') +
        (l.search ? '&amp;q=' + l.search.slice(1).replace(/&amp;/g, '~and~') : '') +
        l.hash
      );
    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre><p>O c√≥digo √© simples mas genial. Se o usu√°rio acessa <code>https://meu.pwa/pagina</code>, o GitHub renderiza o template de <code>404.html</code>. No pr√≥prio template, ele pega a pr√≥pria url e transforma <code>https://meu.pwa/pagina</code> em <code>https://meu.pwa/?p=pagina</code>. A√≠ agora a hist√≥ria √© outra. Estamos indo para <code>index.html</code>, que √© uma p√°gina v√°lida. Ent√£o l√°, precisamos adicionar o seguinte c√≥digo:</p><pre class="prettyprint lang-javascript" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">&lt;script type="text/javascript"&gt;
 // Copyright (c) 2016 Rafael Pedicini, licensed under the MIT License
    (function(l) {
        if (l.search) {
          var q = {};
          l.search.slice(1).split('&amp;').forEach(function(v) {
            var a = v.split('=');
            q[a[0]] = a.slice(1).join('=').replace(/~and~/g, '&amp;');
          });
          if (q.p !== undefined) {
            window.history.replaceState(null, null,
              l.pathname.slice(0, -1) + (q.p || '') +
              (q.q ? ('?' + q.q) : '') +
              l.hash
            );
          }
        }
    }(window.location))
&lt;/script&gt;</pre><p>Aqui termina o truque. Como esse problema de URLS s√≥ acontece quando estamos trabalhando diretamente com a <strong>History API</strong>, o nosso pr√≥prio App vai usar a <strong>pr√≥pria</strong> History API, independente do Framework que voc√™ estiver usando. A√≠ √© garantido que a p√°gina vai ser redirecionada para o conte√∫do esperado.</p><p>A√≠ √© s√≥ correr pro abra√ßo. Se voc√™ quisser ver um exemplo com Polymer funcionando, pode acessar o website web online do <a href="https://io.gdgrecife.com/" target="_blank" rel="external">I/O Extended Pernambuco</a>. Foi justamente por culpa dele que eu descobri como que isso acontece.</p><p>Nada como ser cabe√ßa dura √°s vezes, n√© n√£o?</p></div></article><section id="recadinhos"><span class="h2">Recadinhos <span role="img" aria-label="fire">üî•</span></span><ul class="recadinhos-list clear-list"><li class="recadinhos-item">[<a href="http://pwa.press">PWA Press</a>] Conhe√ßa meu novo Newsletter quinzenal sobre Progressive Web Apps!</li><li class="recadinhos-item">[<a href="https://events.withgoogle.com/google-launchpad-build-recife-12-de-agosto/">Google Launchpad Build Recife</a>] Vai ter talk minha no Launchpad Build Recife sobre Progressive Web Apps, inscreva-se gr√°tis!</li><li class="recadinhos-item">[<a href="https://joseli.to">Updates no blog</a>] Dei uma tapa no visual com umas fontes mais bonitinhas, melhor responsividade e o melhor dom√≠nio possivel</li><li class="recadinhos-item">[<a href="http://youtube.com/c/joselitojunior">JOSE2</a>] Inscreva-se no meu canal no YouTube</li><li class="recadinhos-item">[<a href="http://fb.com/joselitobot">Josebot</a>] Curta minha fanpage e fale com meu bot no Facebook</li></ul></section><div class="poster-footer"><div class="article-share-pls mb2"><strong>Voc√™ gostou desse artigo? Ent√£o compartilhe!</strong><p>Esse √© o melhor jeito de eu saber qual o assunto voc√™s est√£o mais interessados e me motiva a escrever mais!</p><div><amp-social-share type="twitter" class="custom-share-icon" width="50" height="50"></amp-social-share><amp-social-share type="facebook" data-param-app_id="254325784911610" class="custom-share-icon" width="50" height="50"></amp-social-share><amp-social-share type="linkedin" class="custom-share-icon" width="50" height="50"></amp-social-share><amp-social-share type="whatsapp" class="custom-share-icon sm-hide md-hide lg-hide" width="50" height="50"></amp-social-share><amp-social-share type="email" class="custom-share-icon" width="50" height="50"></amp-social-share></div></div><div class="lw">[üìù <a href="https://github.com/joselitojunior1/joseli.to/edit/master/source/_posts/como-hospedar-progressive-web-apps-no-github-pages.md">Edite esse artigo no GitHub</a>] [üîî <a href="https://sininho.joseli.to">Ative as Notifica√ß√µes</a>]</div></div><amp-facebook-comments width="600" height="280" layout="responsive" data-numposts="5" data-href="https://joseli.to/como-hospedar-progressive-web-apps-no-github-pages/"></amp-facebook-comments><div class="keep-reading lw"><strong>Continue lendo:</strong><ul class="inline-list clear-list"><li>[‚á¶ <a href="/voce-talvez-nao-saiba-mas-o-atletico-paranaense-e-o-coritiba-entraram-para-a-historia/">Voc√™ talvez n√£o saiba, mas o Atl√©tico Paranaense e o Coritiba entraram para a hist√≥ria</a>]</li><li>[<a href="/ngrok-resolvendo-os-problemas-de-ssl-e-compartilhamento-do-localhost/">ngrok: resolvendo os problemas de SSL e compartilhamento do localhost</a> ‚á®]</li></ul></div><footer id="footer"><div class="mecenas lw"><strong>Mecenas:</strong> [<a href="https://joselito.pw/_digitalocean">Digital Ocean</a>] [<a href="https://joselito.pw/_umbler">Umbler</a>] [<a href="https://joselito.pw/_booking">Booking</a>] [<a href="https://joselito.pw/_ebanx">Ebanx</a>]</div><small>CC BY-SA &copy; 2017 Joselito J√∫nior</small></footer></div></div><amp-install-serviceworker src="/sw.js" data-iframe-src="/sw.html" layout="nodisplay"></amp-install-serviceworker><amp-analytics type="clicky"><script type="application/json">{"vars": {"site_id": "101052603"}}</script></amp-analytics></body></html>